<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Popup</title>
</head>
<body>
<form id="Words-Form" name="Words">
    <div class="form-body">

    </div>
    <div class="form-actions">
        <button type="button" id="Submit-Btn">Submit</button>
        <button type="button" id="Send-RegExp-Btn">Send RegExp</button>
        <button type="button" id="Send-Date-Btn">Send Date</button>
    </div>
</form>
<script>
    (function () {
        'use strict';

        var words = [
                    'apple', 'banana', 'orange', 'pineapple', 'lime', 'pomegranate', 'apricot', 'peach', 'pear', 'strawberry'
                ],
                form = document.forms['Words'],
                formBody = form.querySelector('.form-body'),
                html = '<input type="checkbox" name="word" value="{{index}}" id="Word-{{index}}"/><label for="Word-{{index}}">{{word}}</label>';

        function addCheckbox(word, index) {
            var div = document.createElement('div');
            div.className = 'input-group input-checkbox';
            div.innerHTML = html.replace(/\{\{index\}\}/g, index).replace("{{word}}", word);
            formBody.appendChild(div);
        }

        words.forEach(addCheckbox);

    }());

    (function () {
        var getId = function (id) {
            return document.getElementById(id);
        }, context = window.opener.Experiment, elements = document.forms['Words'].word;

        getId('Submit-Btn').addEventListener('click', function () {
            var ids = [];

            for (var i = 0, j = elements.length; i < j; i += 1) {
                if (elements[i].checked) {
                    ids.push(parseInt(elements[i].value));
                }
            }

            context.updateText(ids);
            window.close();
        });

        getId('Send-RegExp-Btn').addEventListener('click', function () {
            var regExp = /A[a-z]+e/i;
            context.checkRegExp(regExp);
        });

        getId('Send-Date-Btn').addEventListener('click', function () {
            var now = new Date();
            context.updateDate(now);
        })
    }());
</script>
</body>
</html>